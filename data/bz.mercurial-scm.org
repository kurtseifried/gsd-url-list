https://bz.mercurial-scm.org/show_bug.cgi?id=2407
https://bz.mercurial-scm.org/show_bug.cgi?id=5730
